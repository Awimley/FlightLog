(function(){angular.module("flightApp",["ngRoute","ngSanitize","ui.bootstrap"]);t.$inject=["$routeProvider","$locationProvider"];function t(t,e){t.when("/",{templateUrl:"login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/home",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/logs",{templateUrl:"common/views/logs.view.html",controller:"logsCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});e.html5Mode(true)}angular.module("flightApp").config(["$routeProvider","$locationProvider",t])})();(function(){angular.module("flightApp").controller("homeCtrl",t);t.$inject=["$modal","$scope","flightData","$log"];function t(t,e,o,l){var n=this;n.lastInspection="December 2015";n.pageHeader={title:"N562D App (angular edition!)",strapline:""};o.flightData().success(function(t){n.data={flight:t[t.length-1]};l.debug(n.data.flight)}).error(function(t){console.log(t)});var r=new Date;r=r.toISOString();r=r.slice(5,7)+"/"+r.slice(8,10)+"/"+r.slice(2,4);n.popupAddForm=function(){var e=t.open({templateUrl:"/modals/addModal.view.html",controller:"addModalCtrl as vm",resolve:{flight:function(){return{flt_date:r,hobbs_out:n.data.flight.hobbsIn}}}});e.result.then(function(t){o.flightData().success(function(t){n.data={flight:t[t.length-1]}}).error(function(t){console.log(t)})})}}})();(function(){angular.module("flightApp").controller("logsCtrl",t);t.$inject=["$routeParams","$modal","$scope","flightData","$log"];function t(t,e,o,l,n){var r=this;var a=new Date;a=a.toISOString();a=a.slice(5,7)+"/"+a.slice(8,10)+"/"+a.slice(2,4);r.pageHeader={title:"Logs",strapline:a};l.flightData().success(function(t){r.data={flights:t.reverse()}}).error(function(t){console.log(t)});r.popupUpdateForm=function(t){var o=t.currentTarget.attributes["id"].value;l.flight(o).success(function(t){n.debug(t);var o=e.open({templateUrl:"/modals/updateModal.view.html",controller:"updateModalCtrl as vm",resolve:{flight:function(){return{flight:t}}}});o.result.then(function(t){l.flightData().success(function(t){r.data={flights:t.reverse()}}).error(function(t){n.debug(t)})})}).error(function(t){n.debug(t)})};r.popupAddForm=function(){var t=e.open({templateUrl:"/modals/addModal.view.html",controller:"addModalCtrl as vm",resolve:{flight:function(){return{flt_date:a,hobbs_out:r.data.flights[0].hobbsIn}}}});t.result.then(function(){l.flightData().success(function(t){r.data={flights:t.reverse()}}).error(function(t){n.debug(t)})})}}})();(function(){angular.module("flightApp").controller("updateModalCtrl",t);t.$inject=["$modalInstance","flight","flightData","$log"];function t(t,e,o,l){var n=this;n.formError="";n.data=e.flight;n.onSubmit=function(){if(!n.data.flt_date||!n.data.hobbs_out||!n.data.fuel_out||!n.data.oil_dipstick||n.data.oil_dipstick>12||n.data.fuel_purch>114||n.data.oil_change>1||n.data.oil_change<0){n.formError="Hobbs and fuel out, Date, and Oil Dipstick (< 12 quarts) are required! (also fuel purch must be < 114, oil change 0 or 1)";return false}else{o.updateFlight(n.data);n.formError="";l.debug(n.data);t.close()}};n.deleteFlight=function(){o.deleteFlight(n.data._id);t.close()};n.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("flightApp").controller("addModalCtrl",t);t.$inject=["$modalInstance","flight","flightData","$log"];function t(t,e,o,l){var n=this;n.formError="";n.data=e;n.onSubmit=function(){if(!n.data.flt_date||!n.data.hobbs_out||!n.data.fuel_out||!n.data.oil_dipstick||n.data.oil_dipstick>12||n.data.fuel_purch>114||n.data.oil_change>1||n.data.oil_change<0){n.formError="Hobbs and fuel out, Date, and Oil Dipstick (< 12 quarts) are required! (also fuel purch must be < 114, oil change 0 or 1)";return false}else{n.formError="";l.debug(n.data);console.log(Object.keys(n.data).length);n.doAdd(n.data);n.modal.close()}};n.doAdd=function(t){o.addFlight(t).success(function(t){n.modal.close()}).error(function(t){n.formError="Oops, something went wrong! Try again."})};n.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("flightApp").controller("loginCtrl",t);t.$inject=["$location","$scope"];function t(t,e){var o=this;o.pageHeader={title:"N562D App",strapline:"Have a nice flight!"};o.login=function(){window.location="#/home"}}})();(function(){angular.module("flightApp").service("flightData",t);t.$inject=["$http"];function t(t){var e=function(t){t.hobbs_in=t.hobbs_in||0;t.fuel_in=t.fuel_in||0;t.fuel_purch=t.fuel_purch||0;t.fuel_cost=t.fuel_cost||0;t.oil_added=t.oil_added||0;t.oil_dipstick=t.oil_dipstick||0;t.comment=t.comment||0;t.oil_change=t.oil_change||0;return t};var o=function(){return t.get("/loglist")};var l=function(e){if(e){return t.get("/findone/"+e)}else{return null}};var n=function(o){if(o){o=e(o);return t.post("/logadd",o)}else{return null}};var r=function(o){if(o){o=e(o);return t.put("/logupdate/"+o._id,o)}else{return null}};var a=function(e){if(e){return t.get("/logupdate/delete/"+e)}else{return null}};return{flightData:o,flight:l,addFlight:n,deleteFlight:a,updateFlight:r}}})();(function(){angular.module("flightApp").filter("formatDistance",e);var t=function(t){return!isNaN(parseFloat(t))&&isFinite(t)};function e(){return function(e){var o,l;if(e&&t(e)){if(e>1){o=parseFloat(e).toFixed(1);l="km"}else{o=parseInt(e*1e3,10);l="m"}return o+l}else{return"?"}}}})();(function(){angular.module("flightApp").filter("addHtmlLineBreaks",t);function t(){return function(t){var e=t.replace("/\n/g","<br/>");return e}}})();(function(){angular.module("flightApp").directive("navigation",t);t.$inject=["$modal","flightData"];function t(t,e){var o=this;return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("flightApp").directive("footerGeneric",t);function t(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("flightApp").directive("pageHeader",t);function t(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();