(function(){angular.module("flightApp",["ngRoute","ngSanitize","ui.bootstrap"]);t.$inject=["$routeProvider","$locationProvider"];function t(t,e){t.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/logs",{templateUrl:"common/views/logs.view.html",controller:"logsCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});e.html5Mode(true)}angular.module("flightApp").config(["$routeProvider","$locationProvider",t])})();(function(){angular.module("flightApp").controller("homeCtrl",t);t.$inject=["$modal","$scope","flightData","$log"];function t(t,e,o,n){var l=this;l.lastInspection="December 2015";l.pageHeader={title:"N562D App (angular edition!)",strapline:"Have a nice flight!"};o.flightData().success(function(t){l.data={flight:t[t.length-1]};n.debug(l.data.flight)}).error(function(t){console.log(t)});var a=new Date;a=a.toISOString();a=a.slice(5,7)+"/"+a.slice(8,10)+"/"+a.slice(2,4);l.popupAddForm=function(){var e=t.open({templateUrl:"/modals/addModal.view.html",controller:"addModalCtrl as vm",resolve:{flight:function(){return{flt_date:a,hobbs_out:l.data.flight.hobbsIn}}}});e.result.then(function(t){o.flightData().success(function(t){l.data={flight:t[t.length-1]}}).error(function(t){console.log(t)})})};l.popupLogin=function(){}}})();(function(){angular.module("flightApp").controller("logsCtrl",t);t.$inject=["$routeParams","$modal","$scope","flightData","$log"];function t(t,e,o,n,l){var a=this;var r=new Date;r=r.toISOString();r=r.slice(5,7)+"/"+r.slice(8,10)+"/"+r.slice(2,4);a.pageHeader={title:"Logs",strapline:r};n.flightData().success(function(t){a.data={flights:t.reverse()}}).error(function(t){console.log(t)});a.popupUpdateForm=function(t){var o=t.currentTarget.attributes["id"].value;n.flight(o).success(function(t){l.debug(t);var o=e.open({templateUrl:"/modals/updateModal.view.html",controller:"updateModalCtrl as vm",resolve:{flight:function(){return{flight:t}}}});o.result.then(function(t){n.flightData().success(function(t){a.data={flights:t.reverse()}}).error(function(t){l.debug(t)})})}).error(function(t){l.debug(t)})}}})();(function(){angular.module("flightApp").controller("updateModalCtrl",t);t.$inject=["$modalInstance","flight","flightData","$log"];function t(t,e,o,n){var l=this;l.formError="";l.data=e.flight;l.onSubmit=function(){if(!l.data.flt_date||!l.data.hobbs_out||!l.data.fuel_out||!l.data.oil_dipstick||l.data.oil_dipstick>12||l.data.fuel_purch>114||l.data.oil_change>1||l.data.oil_change<0){l.formError="Hobbs and fuel out, Date, and Oil Dipstick (< 12 quarts) are required! (also fuel purch must be < 114, oil change 0 or 1)";return false}else{o.updateFlight(l.data);l.formError="";n.debug(l.data);t.close()}};l.deleteFlight=function(){o.deleteFlight(l.data._id);t.close()};l.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("flightApp").controller("addModalCtrl",t);t.$inject=["$modalInstance","flight","flightData","$log"];function t(t,e,o,n){var l=this;l.formError="";l.data=e;l.onSubmit=function(){if(!l.data.flt_date||!l.data.hobbs_out||!l.data.fuel_out||!l.data.oil_dipstick||l.data.oil_dipstick>12||l.data.fuel_purch>114||l.data.oil_change>1||l.data.oil_change<0){l.formError="Hobbs and fuel out, Date, and Oil Dipstick (< 12 quarts) are required! (also fuel purch must be < 114, oil change 0 or 1)";return false}else{l.formError="";n.debug(l.data);console.log(Object.keys(l.data).length);l.doAdd(l.data);l.modal.close()}};l.doAdd=function(t){o.addFlight(t).success(function(t){l.modal.close(t)}).error(function(t){l.formError="Oops, something went wrong! Try again."})};l.modal={close:function(e){t.close(e)},cancel:function(){t.dismiss("cancel")}}}})();(function(){angular.module("flightApp").service("flightData",t);t.$inject=["$http"];function t(t){var e=function(t){t.hobbs_in=t.hobbs_in||0;t.fuel_in=t.fuel_in||0;t.fuel_purch=t.fuel_purch||0;t.fuel_cost=t.fuel_cost||0;t.oil_added=t.oil_added||0;t.oil_dipstick=t.oil_dipstick||0;t.comment=t.comment||0;t.oil_change=t.oil_change||0;return t};var o=function(){return t.get("/loglist")};var n=function(e){if(e){return t.get("/findone/"+e)}else{return null}};var l=function(o){if(o){o=e(o);return t.post("/logadd",o)}else{return null}};var a=function(o){if(o){o=e(o);return t.put("/logupdate/"+o._id,o)}else{return null}};var r=function(e){if(e){return t.get("/logupdate/delete/"+e)}else{return null}};return{flightData:o,flight:n,addFlight:l,deleteFlight:r,updateFlight:a}}})();(function(){angular.module("flightApp").filter("formatDistance",e);var t=function(t){return!isNaN(parseFloat(t))&&isFinite(t)};function e(){return function(e){var o,n;if(e&&t(e)){if(e>1){o=parseFloat(e).toFixed(1);n="km"}else{o=parseInt(e*1e3,10);n="m"}return o+n}else{return"?"}}}})();(function(){angular.module("flightApp").filter("addHtmlLineBreaks",t);function t(){return function(t){var e=t.replace("/\n/g","<br/>");return e}}})();(function(){angular.module("flightApp").directive("navigation",t);t.$inject=["$modal","flightData"];function t(t,e){var o=this;return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("flightApp").directive("footerGeneric",t);function t(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("flightApp").directive("pageHeader",t);function t(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();